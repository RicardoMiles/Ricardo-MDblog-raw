 # â€œæŒ‡é’ˆ + å†…å­˜ç®¡ç† + ä½œç”¨åŸŸâ€ ä¸“é¡¹è®­ç»ƒ

## ğŸŒ± **è®­ç»ƒç›®æ ‡ï¼š**

1. ææ¸…æ¥šï¼š
   - ä»€ä¹ˆæ˜¯é‡æŒ‡é’ˆã€ç©ºæŒ‡é’ˆã€æ‚¬æŒ‚æŒ‡é’ˆ
   - å“ªäº›æƒ…å†µä¸‹éœ€è¦ `malloc`ï¼Ÿå“ªäº›ä¸éœ€è¦ï¼Ÿ
   - ç»“æ„ä½“é‡Œæœ‰æŒ‡é’ˆæˆå‘˜ï¼Œä¸ºä»€ä¹ˆè¦å•ç‹¬ `malloc`ï¼Ÿ
   - `malloc` + `free` æˆå¯¹ä½¿ç”¨ï¼Œä½•æ—¶è¯¥é‡Šæ”¾ï¼Ÿ
   - æ•°ç»„å’ŒæŒ‡é’ˆçš„æœ¬è´¨åŒºåˆ«
2. å­¦ä¼šï¼š
   - å‘ç°ä½œç”¨åŸŸå†²çªï¼ˆå˜é‡åè¦†ç›–ã€é‡å¤å®šä¹‰ï¼‰
   - åˆ¤æ–­ä¸€ä¸ªæŒ‡é’ˆå½“å‰æœ‰æ²¡æœ‰æœ‰æ•ˆå†…å­˜
   - ç®€å•æ‰‹å†™å†…å­˜æ³„æ¼æ£€æµ‹å·¥å…·ï¼ˆç”¨æ¥æ£€æŸ¥ä½ è‡ªå·±å†™çš„ä»£ç ï¼‰

------

## ğŸ‹ï¸â€â™‚ï¸ **è®­ç»ƒåˆ†ä¸º 4 ä¸ªé˜¶æ®µï¼š**

### **ç¬¬ 1 é˜¶æ®µï¼šæŒ‡é’ˆå’Œæ•°ç»„çš„åŸºæœ¬è®¤çŸ¥**

> ç›®æ ‡ï¼šç†è§£ `int* p` å’Œ `int arr[]` åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚

**ç»ƒä¹  1ï¼šæŒ‡é’ˆå’Œæ•°ç»„çš„åœ°å€å·®åˆ«**

```c
#include <stdio.h>

int main() {
    int arr[5] = {1, 2, 3, 4, 5};
    int* p = arr;

    printf("Address of arr: %p\n", (void*)arr);
    printf("Address of p: %p\n", (void*)&p);
    printf("Value of p (points to): %p\n", (void*)p);

    return 0;
}
```

ğŸ‘‰ **é—®é¢˜ï¼š**

- `arr` å’Œ `&p` åœ°å€ä¸€æ ·å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
- `p = arr` å’Œ `p = &arr` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

------

### **ç¬¬ 2 é˜¶æ®µï¼šmalloc åˆ†é…å†…å­˜ + free é‡Šæ”¾å†…å­˜**

> ç›®æ ‡ï¼šç†è§£å †åŒºåˆ†é…å’Œæ ˆåŒºåˆ†é…çš„åŒºåˆ«ã€‚

**ç»ƒä¹  2ï¼šåŠ¨æ€æ•°ç»„çš„æ­£ç¡®ä½¿ç”¨**

```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    int* p = (int*)malloc(5 * sizeof(int));
    if (p == NULL) {
        printf("Memory allocation failed!\n");
        return 1;
    }

    for (int i = 0; i < 5; i++) {
        p[i] = i * 10;
    }

    for (int i = 0; i < 5; i++) {
        printf("%d ", p[i]);
    }
    printf("\n");

    free(p);  // åŠ äº†è¿™ä¸€è¡Œå’Œä¸åŠ è¿™ä¸€è¡Œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

    return 0;
}
```

ğŸ‘‰ **é—®é¢˜ï¼š**

- å¦‚æœå¿˜äº† `free(p)`ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿï¼ˆå†…å­˜æ³„æ¼ï¼‰
- å¦‚æœ `free(p)` ä¸¤æ¬¡ï¼Œä¼šæ€æ ·ï¼Ÿï¼ˆæ‚¬æŒ‚æŒ‡é’ˆï¼‰
- `p = NULL` ä¹‹åè¿˜èƒ½ `free(p)` å—ï¼Ÿ

------

### **ç¬¬ 3 é˜¶æ®µï¼šç»“æ„ä½“é‡Œæœ‰æŒ‡é’ˆæˆå‘˜ï¼Œå¦‚ä½•å®‰å…¨åˆ†é…å’Œé‡Šæ”¾ï¼Ÿ**

> ç›®æ ‡ï¼šç†è§£ç»“æ„ä½“å†…æŒ‡é’ˆæˆå‘˜éœ€è¦å•ç‹¬ `malloc`ã€‚

**ç»ƒä¹  3ï¼šç»“æ„ä½“ + æŒ‡é’ˆæˆå‘˜åˆ†é…**

```c
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    int* data;
    int size;
} MyStruct;

int main() {
    MyStruct s;
    s.size = 5;
    s.data = (int*)malloc(sizeof(int) * s.size);
    if (s.data == NULL) {
        printf("Memory allocation failed!\n");
        return 1;
    }

    for (int i = 0; i < s.size; i++) {
        s.data[i] = i + 1;
    }

    for (int i = 0; i < s.size; i++) {
        printf("%d ", s.data[i]);
    }
    printf("\n");

    free(s.data);  // âš ï¸ ä¸€å®šè¦é‡Šæ”¾ç»“æ„ä½“æˆå‘˜

    return 0;
}
```

ğŸ‘‰ **é—®é¢˜ï¼š**

- ä¸ºä»€ä¹ˆç»“æ„ä½“ `s` ä¸ç”¨ `free`ï¼Œä½† `s.data` è¦ `free`ï¼Ÿ
- å¦‚æœæ˜¯ `MyStruct* s = malloc(sizeof(MyStruct));`ï¼Œè¯¥æ€ä¹ˆé‡Šæ”¾ï¼Ÿ

------

### **ç¬¬ 4 é˜¶æ®µï¼šä½œç”¨åŸŸå†²çª + å†…å­˜æ£€æµ‹**

> ç›®æ ‡ï¼šé¿å…å˜é‡åè¦†ç›–ã€å­¦ä¼šæŸ¥å†…å­˜æ³„æ¼ã€‚

**ç»ƒä¹  4ï¼šå˜é‡ä½œç”¨åŸŸå†²çª**

```c
#include <stdio.h>

int main() {
    int i = 5;
    for (int i = 0; i < 3; i++) {  // å¤–é¢ä¹Ÿæœ‰ iï¼Œä¼šä¸ä¼šæœ‰é—®é¢˜ï¼Ÿ
        printf("Inner loop i = %d\n", i);
    }
    printf("Outer i = %d\n", i);

    return 0;
}
```

ğŸ‘‰ **é—®é¢˜ï¼š**

- å†…å±‚å¾ªç¯çš„ `i` ä¼šå½±å“å¤–å±‚å—ï¼Ÿ
- `for (int i = ...` å’Œ `int i; for (i = ...` æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

------

## â­ ã€Bonusã€‘ç®€å•å†…å­˜æ³„æ¼æ£€æµ‹ï¼ˆæ‰‹å†™ç‰ˆï¼‰ï¼š

> è®°å½•æ¯æ¬¡ `malloc` å’Œ `free`ï¼Œæœ€åçœ‹çœ‹æœ‰æ²¡æœ‰æ²¡é‡Šæ”¾çš„ã€‚